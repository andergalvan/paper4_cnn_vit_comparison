nohup: ignoring input
/home/ubuntu/.local/lib/python3.10/site-packages/torchvision/models/inception.py:43: FutureWarning: The default weight initialization of inception_v3 will be changed in future releases of torchvision. If you wish to keep the old behavior (which leads to long initialization times due to scipy/scipy#11299), please set init_weights=True.
  warnings.warn(

==================================================
Starting fine-tuning for model: inception_v3
==================================================

	Loading training and validation dataloaders...
	Training and validation dataloaders loaded.

	Loading model...
	Model loaded from: /home/ubuntu/Paper4_CNN_ViT_Comparison/pretraining/checkpoints/checkpoint_inception_v3/best_model.pt

	Total model parameters: 21,990,468

	Epoch [1/40] - Train Loss: 4.5052 (5.03%), Val Loss: 4.3298 (23.50%)
		✅ Best model updated: Val Acc = 23.50%

	Epoch [2/40] - Train Loss: 4.1901 (26.24%), Val Loss: 3.9678 (48.70%)
		✅ Best model updated: Val Acc = 48.70%

	Epoch [3/40] - Train Loss: 3.8236 (47.44%), Val Loss: 3.5493 (59.90%)
		✅ Best model updated: Val Acc = 59.90%

	Epoch [4/40] - Train Loss: 3.4161 (59.14%), Val Loss: 3.2015 (65.70%)
		✅ Best model updated: Val Acc = 65.70%

	Epoch [5/40] - Train Loss: 3.0138 (66.54%), Val Loss: 2.8439 (69.60%)
		✅ Best model updated: Val Acc = 69.60%

	Epoch [6/40] - Train Loss: 2.6496 (72.39%), Val Loss: 2.4960 (73.30%)
		✅ Best model updated: Val Acc = 73.30%

	Epoch [7/40] - Train Loss: 2.3022 (77.06%), Val Loss: 2.2102 (76.20%)
		✅ Best model updated: Val Acc = 76.20%

	Epoch [8/40] - Train Loss: 1.9922 (80.11%), Val Loss: 1.9528 (78.50%)
		✅ Best model updated: Val Acc = 78.50%

	Epoch [9/40] - Train Loss: 1.7185 (82.74%), Val Loss: 1.7502 (79.90%)
		✅ Best model updated: Val Acc = 79.90%

	Epoch [10/40] - Train Loss: 1.4762 (85.44%), Val Loss: 1.5357 (80.90%)
		✅ Best model updated: Val Acc = 80.90%

	Epoch [11/40] - Train Loss: 1.2606 (87.16%), Val Loss: 1.3762 (81.90%)
		✅ Best model updated: Val Acc = 81.90%

	Epoch [12/40] - Train Loss: 1.0855 (88.91%), Val Loss: 1.2482 (83.10%)
		✅ Best model updated: Val Acc = 83.10%

	Epoch [13/40] - Train Loss: 0.9373 (89.90%), Val Loss: 1.1238 (83.40%)
		✅ Best model updated: Val Acc = 83.40%

	Epoch [14/40] - Train Loss: 0.8135 (91.70%), Val Loss: 1.0213 (84.00%)
		✅ Best model updated: Val Acc = 84.00%

	Epoch [15/40] - Train Loss: 0.7000 (92.53%), Val Loss: 0.9645 (84.40%)
		✅ Best model updated: Val Acc = 84.40%

	Epoch [16/40] - Train Loss: 0.6072 (93.73%), Val Loss: 0.8977 (84.90%)
		✅ Best model updated: Val Acc = 84.90%

	Epoch [17/40] - Train Loss: 0.5238 (94.66%), Val Loss: 0.8647 (85.20%)
		✅ Best model updated: Val Acc = 85.20%

	Epoch [18/40] - Train Loss: 0.4530 (95.47%), Val Loss: 0.8246 (85.60%)
		✅ Best model updated: Val Acc = 85.60%

	Epoch [19/40] - Train Loss: 0.3932 (96.21%), Val Loss: 0.8043 (85.40%)

	Epoch [20/40] - Train Loss: 0.3418 (96.70%), Val Loss: 0.7731 (86.00%)
		✅ Best model updated: Val Acc = 86.00%

	Epoch [21/40] - Train Loss: 0.2938 (97.39%), Val Loss: 0.7511 (86.20%)
		✅ Best model updated: Val Acc = 86.20%

	Epoch [22/40] - Train Loss: 0.2513 (97.84%), Val Loss: 0.7442 (86.20%)

	Epoch [23/40] - Train Loss: 0.2194 (98.33%), Val Loss: 0.7348 (85.70%)

	Epoch [24/40] - Train Loss: 0.1953 (98.49%), Val Loss: 0.7256 (85.70%)

	Epoch [25/40] - Train Loss: 0.1670 (98.83%), Val Loss: 0.7093 (86.20%)

	Epoch [26/40] - Train Loss: 0.1472 (99.07%), Val Loss: 0.7053 (86.00%)

	Epoch [27/40] - Train Loss: 0.1268 (99.33%), Val Loss: 0.6986 (86.10%)

	Epoch [28/40] - Train Loss: 0.1133 (99.40%), Val Loss: 0.6924 (86.00%)

	Epoch [29/40] - Train Loss: 0.0987 (99.57%), Val Loss: 0.6892 (85.90%)

	Epoch [30/40] - Train Loss: 0.0879 (99.60%), Val Loss: 0.6825 (85.90%)

	Epoch [31/40] - Train Loss: 0.0786 (99.70%), Val Loss: 0.6770 (86.20%)

	Epoch [32/40] - Train Loss: 0.0713 (99.69%), Val Loss: 0.6762 (85.90%)

	Epoch [33/40] - Train Loss: 0.0638 (99.77%), Val Loss: 0.6722 (86.00%)

	Epoch [34/40] - Train Loss: 0.0570 (99.80%), Val Loss: 0.6690 (85.80%)

	Epoch [35/40] - Train Loss: 0.0522 (99.80%), Val Loss: 0.6736 (85.80%)

	Epoch [36/40] - Train Loss: 0.0480 (99.84%), Val Loss: 0.6775 (85.40%)

	Epoch [37/40] - Train Loss: 0.0429 (99.86%), Val Loss: 0.6703 (86.20%)

	Epoch [38/40] - Train Loss: 0.0396 (99.87%), Val Loss: 0.6665 (86.00%)

	Epoch [39/40] - Train Loss: 0.0360 (99.91%), Val Loss: 0.6663 (85.90%)

	Epoch [40/40] - Train Loss: 0.0330 (99.93%), Val Loss: 0.6581 (86.20%)

	Best model saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_inception_v3/best_model_inception_v3_100.pth
	Metric plot saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_inception_v3/fine_tuning_metrics.png

==================================================
Starting fine-tuning for model: resnet50
==================================================

	Loading training and validation dataloaders...
	Training and validation dataloaders loaded.

	Loading model...
	Model loaded from: /home/ubuntu/Paper4_CNN_ViT_Comparison/pretraining/checkpoints/checkpoint_resnet50/best_model.pt

	Total model parameters: 23,712,932

	Epoch [1/40] - Train Loss: 4.3101 (13.47%), Val Loss: 3.8288 (36.50%)
		✅ Best model updated: Val Acc = 36.50%

	Epoch [2/40] - Train Loss: 3.4159 (55.60%), Val Loss: 2.8464 (64.70%)
		✅ Best model updated: Val Acc = 64.70%

	Epoch [3/40] - Train Loss: 2.4953 (73.96%), Val Loss: 2.1039 (76.00%)
		✅ Best model updated: Val Acc = 76.00%

	Epoch [4/40] - Train Loss: 1.7904 (81.56%), Val Loss: 1.6292 (80.40%)
		✅ Best model updated: Val Acc = 80.40%

	Epoch [5/40] - Train Loss: 1.3167 (85.61%), Val Loss: 1.2964 (83.70%)
		✅ Best model updated: Val Acc = 83.70%

	Epoch [6/40] - Train Loss: 1.0064 (88.01%), Val Loss: 1.0689 (85.40%)
		✅ Best model updated: Val Acc = 85.40%

	Epoch [7/40] - Train Loss: 0.7955 (90.21%), Val Loss: 0.9078 (86.50%)
		✅ Best model updated: Val Acc = 86.50%

	Epoch [8/40] - Train Loss: 0.6453 (91.24%), Val Loss: 0.8173 (87.60%)
		✅ Best model updated: Val Acc = 87.60%

	Epoch [9/40] - Train Loss: 0.5329 (93.36%), Val Loss: 0.7467 (86.90%)

	Epoch [10/40] - Train Loss: 0.4491 (94.26%), Val Loss: 0.6949 (88.00%)
		✅ Best model updated: Val Acc = 88.00%

	Epoch [11/40] - Train Loss: 0.3804 (95.34%), Val Loss: 0.6516 (88.20%)
		✅ Best model updated: Val Acc = 88.20%

	Epoch [12/40] - Train Loss: 0.3162 (96.13%), Val Loss: 0.6279 (88.20%)

	Epoch [13/40] - Train Loss: 0.2694 (96.71%), Val Loss: 0.6029 (88.30%)
		✅ Best model updated: Val Acc = 88.30%

	Epoch [14/40] - Train Loss: 0.2282 (97.53%), Val Loss: 0.5854 (88.70%)
		✅ Best model updated: Val Acc = 88.70%

	Epoch [15/40] - Train Loss: 0.1912 (97.86%), Val Loss: 0.5663 (89.00%)
		✅ Best model updated: Val Acc = 89.00%

	Epoch [16/40] - Train Loss: 0.1645 (98.47%), Val Loss: 0.5620 (88.80%)

	Epoch [17/40] - Train Loss: 0.1369 (98.81%), Val Loss: 0.5504 (89.40%)
		✅ Best model updated: Val Acc = 89.40%

	Epoch [18/40] - Train Loss: 0.1194 (99.10%), Val Loss: 0.5494 (89.40%)

	Epoch [19/40] - Train Loss: 0.1000 (99.37%), Val Loss: 0.5471 (89.40%)

	Epoch [20/40] - Train Loss: 0.0838 (99.50%), Val Loss: 0.5376 (89.60%)
		✅ Best model updated: Val Acc = 89.60%

	Epoch [21/40] - Train Loss: 0.0728 (99.73%), Val Loss: 0.5330 (89.80%)
		✅ Best model updated: Val Acc = 89.80%

	Epoch [22/40] - Train Loss: 0.0633 (99.73%), Val Loss: 0.5292 (89.70%)

	Epoch [23/40] - Train Loss: 0.0534 (99.84%), Val Loss: 0.5278 (89.30%)

	Epoch [24/40] - Train Loss: 0.0472 (99.91%), Val Loss: 0.5266 (89.70%)

	Epoch [25/40] - Train Loss: 0.0418 (99.94%), Val Loss: 0.5230 (89.20%)

	Epoch [26/40] - Train Loss: 0.0363 (99.94%), Val Loss: 0.5204 (89.50%)

	Epoch [27/40] - Train Loss: 0.0321 (99.99%), Val Loss: 0.5204 (89.70%)

	Epoch [28/40] - Train Loss: 0.0286 (99.99%), Val Loss: 0.5178 (89.30%)

	Epoch [29/40] - Train Loss: 0.0259 (99.99%), Val Loss: 0.5180 (89.40%)

	Epoch [30/40] - Train Loss: 0.0232 (99.99%), Val Loss: 0.5173 (89.60%)

	Epoch [31/40] - Train Loss: 0.0211 (99.99%), Val Loss: 0.5158 (89.40%)

	Epoch [32/40] - Train Loss: 0.0196 (99.99%), Val Loss: 0.5136 (89.60%)

	Epoch [33/40] - Train Loss: 0.0178 (99.99%), Val Loss: 0.5106 (89.70%)

	Epoch [34/40] - Train Loss: 0.0168 (100.00%), Val Loss: 0.5136 (89.30%)

	Epoch [35/40] - Train Loss: 0.0151 (100.00%), Val Loss: 0.5147 (89.50%)

	Epoch [36/40] - Train Loss: 0.0139 (100.00%), Val Loss: 0.5111 (89.40%)

	Epoch [37/40] - Train Loss: 0.0132 (100.00%), Val Loss: 0.5169 (89.40%)

	Epoch [38/40] - Train Loss: 0.0121 (100.00%), Val Loss: 0.5175 (89.40%)

	Epoch [39/40] - Train Loss: 0.0113 (100.00%), Val Loss: 0.5137 (89.30%)

	Epoch [40/40] - Train Loss: 0.0105 (100.00%), Val Loss: 0.5113 (89.60%)

	Best model saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_resnet50/best_model_resnet50_100.pth
	Metric plot saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_resnet50/fine_tuning_metrics.png

==================================================
Starting fine-tuning for model: densenet201
==================================================

	Loading training and validation dataloaders...
	Training and validation dataloaders loaded.

	Loading model...
	Model loaded from: /home/ubuntu/Paper4_CNN_ViT_Comparison/pretraining/checkpoints/checkpoint_densenet201/best_model.pt

	Total model parameters: 18,285,028

	Epoch [1/40] - Train Loss: 4.3849 (9.79%), Val Loss: 4.0554 (29.20%)
		✅ Best model updated: Val Acc = 29.20%

	Epoch [2/40] - Train Loss: 3.7650 (48.96%), Val Loss: 3.4141 (58.40%)
		✅ Best model updated: Val Acc = 58.40%

	Epoch [3/40] - Train Loss: 3.1326 (70.64%), Val Loss: 2.8271 (72.00%)
		✅ Best model updated: Val Acc = 72.00%

	Epoch [4/40] - Train Loss: 2.5544 (78.80%), Val Loss: 2.3512 (77.90%)
		✅ Best model updated: Val Acc = 77.90%

	Epoch [5/40] - Train Loss: 2.0774 (83.50%), Val Loss: 1.9554 (82.20%)
		✅ Best model updated: Val Acc = 82.20%

	Epoch [6/40] - Train Loss: 1.6949 (86.24%), Val Loss: 1.6503 (84.50%)
		✅ Best model updated: Val Acc = 84.50%

	Epoch [7/40] - Train Loss: 1.3875 (88.21%), Val Loss: 1.4129 (85.70%)
		✅ Best model updated: Val Acc = 85.70%

	Epoch [8/40] - Train Loss: 1.1541 (89.81%), Val Loss: 1.1883 (86.70%)
		✅ Best model updated: Val Acc = 86.70%

	Epoch [9/40] - Train Loss: 0.9644 (91.10%), Val Loss: 1.0580 (87.50%)
		✅ Best model updated: Val Acc = 87.50%

	Epoch [10/40] - Train Loss: 0.8162 (92.14%), Val Loss: 0.9349 (88.50%)
		✅ Best model updated: Val Acc = 88.50%

	Epoch [11/40] - Train Loss: 0.7002 (93.11%), Val Loss: 0.8475 (89.30%)
		✅ Best model updated: Val Acc = 89.30%

	Epoch [12/40] - Train Loss: 0.6046 (93.93%), Val Loss: 0.7801 (89.50%)
		✅ Best model updated: Val Acc = 89.50%

	Epoch [13/40] - Train Loss: 0.5261 (94.54%), Val Loss: 0.7257 (90.00%)
		✅ Best model updated: Val Acc = 90.00%

	Epoch [14/40] - Train Loss: 0.4608 (95.43%), Val Loss: 0.6837 (89.90%)

	Epoch [15/40] - Train Loss: 0.3997 (95.83%), Val Loss: 0.6411 (90.30%)
		✅ Best model updated: Val Acc = 90.30%

	Epoch [16/40] - Train Loss: 0.3536 (96.44%), Val Loss: 0.6028 (90.30%)

	Epoch [17/40] - Train Loss: 0.3119 (96.89%), Val Loss: 0.5857 (90.30%)

	Epoch [18/40] - Train Loss: 0.2747 (97.40%), Val Loss: 0.5654 (90.60%)
		✅ Best model updated: Val Acc = 90.60%

	Epoch [19/40] - Train Loss: 0.2455 (97.73%), Val Loss: 0.5497 (90.20%)

	Epoch [20/40] - Train Loss: 0.2146 (98.04%), Val Loss: 0.5370 (90.10%)

	Epoch [21/40] - Train Loss: 0.1892 (98.41%), Val Loss: 0.5199 (90.60%)

	Epoch [22/40] - Train Loss: 0.1652 (98.71%), Val Loss: 0.5094 (90.20%)

	Epoch [23/40] - Train Loss: 0.1452 (99.00%), Val Loss: 0.5065 (90.50%)

	Epoch [24/40] - Train Loss: 0.1315 (99.17%), Val Loss: 0.4905 (90.40%)

	Epoch [25/40] - Train Loss: 0.1155 (99.44%), Val Loss: 0.4847 (90.60%)

	Epoch [26/40] - Train Loss: 0.1015 (99.53%), Val Loss: 0.4776 (90.40%)

	Epoch [27/40] - Train Loss: 0.0897 (99.63%), Val Loss: 0.4766 (90.20%)

	Epoch [28/40] - Train Loss: 0.0801 (99.66%), Val Loss: 0.4729 (90.40%)

	Epoch [29/40] - Train Loss: 0.0718 (99.73%), Val Loss: 0.4639 (90.40%)

	Epoch [30/40] - Train Loss: 0.0641 (99.80%), Val Loss: 0.4602 (90.50%)

	Epoch [31/40] - Train Loss: 0.0576 (99.83%), Val Loss: 0.4592 (90.30%)

	Epoch [32/40] - Train Loss: 0.0530 (99.91%), Val Loss: 0.4603 (90.30%)

	Epoch [33/40] - Train Loss: 0.0479 (99.91%), Val Loss: 0.4557 (90.30%)

	Epoch [34/40] - Train Loss: 0.0439 (99.91%), Val Loss: 0.4539 (90.10%)

	Epoch [35/40] - Train Loss: 0.0396 (99.99%), Val Loss: 0.4489 (90.30%)

	Epoch [36/40] - Train Loss: 0.0364 (100.00%), Val Loss: 0.4483 (90.50%)

	Epoch [37/40] - Train Loss: 0.0336 (99.99%), Val Loss: 0.4474 (90.10%)

	Epoch [38/40] - Train Loss: 0.0301 (100.00%), Val Loss: 0.4456 (90.20%)

	Epoch [39/40] - Train Loss: 0.0281 (100.00%), Val Loss: 0.4440 (90.20%)

	Epoch [40/40] - Train Loss: 0.0254 (100.00%), Val Loss: 0.4435 (90.40%)

	Best model saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_densenet201/best_model_densenet201_100.pth
	Metric plot saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_densenet201/fine_tuning_metrics.png

==================================================
Starting fine-tuning for model: mobilenet_v3_large
==================================================

	Loading training and validation dataloaders...
	Training and validation dataloaders loaded.

	Loading model...
	Model loaded from: /home/ubuntu/Paper4_CNN_ViT_Comparison/pretraining/checkpoints/checkpoint_mobilenet_v3_large/best_model.pt

	Total model parameters: 4,330,132

	Epoch [1/40] - Train Loss: 4.5535 (2.71%), Val Loss: 4.4022 (4.90%)
		✅ Best model updated: Val Acc = 4.90%

	Epoch [2/40] - Train Loss: 4.1890 (12.71%), Val Loss: 3.9819 (19.50%)
		✅ Best model updated: Val Acc = 19.50%

	Epoch [3/40] - Train Loss: 3.5637 (29.70%), Val Loss: 3.2270 (35.90%)
		✅ Best model updated: Val Acc = 35.90%

	Epoch [4/40] - Train Loss: 2.7034 (47.79%), Val Loss: 2.3832 (51.30%)
		✅ Best model updated: Val Acc = 51.30%

	Epoch [5/40] - Train Loss: 1.9556 (61.47%), Val Loss: 1.7954 (63.00%)
		✅ Best model updated: Val Acc = 63.00%

	Epoch [6/40] - Train Loss: 1.4345 (71.54%), Val Loss: 1.4417 (69.60%)
		✅ Best model updated: Val Acc = 69.60%

	Epoch [7/40] - Train Loss: 1.0909 (78.10%), Val Loss: 1.2171 (73.80%)
		✅ Best model updated: Val Acc = 73.80%

	Epoch [8/40] - Train Loss: 0.8738 (82.00%), Val Loss: 1.0738 (75.90%)
		✅ Best model updated: Val Acc = 75.90%

	Epoch [9/40] - Train Loss: 0.7201 (85.13%), Val Loss: 0.9789 (78.00%)
		✅ Best model updated: Val Acc = 78.00%

	Epoch [10/40] - Train Loss: 0.6063 (87.51%), Val Loss: 0.9069 (79.50%)
		✅ Best model updated: Val Acc = 79.50%

	Epoch [11/40] - Train Loss: 0.5089 (89.66%), Val Loss: 0.8573 (80.90%)
		✅ Best model updated: Val Acc = 80.90%

	Epoch [12/40] - Train Loss: 0.4454 (90.84%), Val Loss: 0.8191 (82.10%)
		✅ Best model updated: Val Acc = 82.10%

	Epoch [13/40] - Train Loss: 0.3810 (92.50%), Val Loss: 0.7952 (82.00%)

	Epoch [14/40] - Train Loss: 0.3311 (93.44%), Val Loss: 0.7694 (82.10%)

	Epoch [15/40] - Train Loss: 0.2801 (94.89%), Val Loss: 0.7534 (82.90%)
		✅ Best model updated: Val Acc = 82.90%

	Epoch [16/40] - Train Loss: 0.2469 (95.41%), Val Loss: 0.7410 (82.50%)

	Epoch [17/40] - Train Loss: 0.2101 (96.51%), Val Loss: 0.7281 (83.10%)
		✅ Best model updated: Val Acc = 83.10%

	Epoch [18/40] - Train Loss: 0.1788 (97.06%), Val Loss: 0.7261 (83.10%)

	Epoch [19/40] - Train Loss: 0.1567 (97.61%), Val Loss: 0.7196 (83.20%)
		✅ Best model updated: Val Acc = 83.20%

	Epoch [20/40] - Train Loss: 0.1320 (98.16%), Val Loss: 0.7134 (83.40%)
		✅ Best model updated: Val Acc = 83.40%

	Epoch [21/40] - Train Loss: 0.1156 (98.66%), Val Loss: 0.7133 (83.50%)
		✅ Best model updated: Val Acc = 83.50%

	Epoch [22/40] - Train Loss: 0.0987 (98.86%), Val Loss: 0.7092 (83.50%)

	Epoch [23/40] - Train Loss: 0.0835 (99.29%), Val Loss: 0.7062 (84.00%)
		✅ Best model updated: Val Acc = 84.00%

	Epoch [24/40] - Train Loss: 0.0713 (99.41%), Val Loss: 0.7041 (83.70%)

	Epoch [25/40] - Train Loss: 0.0633 (99.53%), Val Loss: 0.7040 (84.00%)

	Epoch [26/40] - Train Loss: 0.0557 (99.64%), Val Loss: 0.7066 (84.30%)
		✅ Best model updated: Val Acc = 84.30%

	Epoch [27/40] - Train Loss: 0.0473 (99.77%), Val Loss: 0.7088 (84.20%)

	Epoch [28/40] - Train Loss: 0.0428 (99.87%), Val Loss: 0.7158 (84.10%)

	Epoch [29/40] - Train Loss: 0.0369 (99.90%), Val Loss: 0.7116 (83.90%)

	Epoch [30/40] - Train Loss: 0.0326 (99.96%), Val Loss: 0.7102 (84.10%)

	Epoch [31/40] - Train Loss: 0.0309 (99.93%), Val Loss: 0.7136 (84.20%)

	Epoch [32/40] - Train Loss: 0.0276 (99.93%), Val Loss: 0.7125 (84.50%)
		✅ Best model updated: Val Acc = 84.50%

	Epoch [33/40] - Train Loss: 0.0254 (99.89%), Val Loss: 0.7115 (84.30%)

	Epoch [34/40] - Train Loss: 0.0231 (99.96%), Val Loss: 0.7100 (84.80%)
		✅ Best model updated: Val Acc = 84.80%

	Epoch [35/40] - Train Loss: 0.0209 (99.97%), Val Loss: 0.7119 (84.50%)

	Epoch [36/40] - Train Loss: 0.0184 (99.96%), Val Loss: 0.7133 (84.70%)

	Epoch [37/40] - Train Loss: 0.0178 (99.96%), Val Loss: 0.7149 (84.60%)

	Epoch [38/40] - Train Loss: 0.0152 (100.00%), Val Loss: 0.7154 (84.70%)

	Epoch [39/40] - Train Loss: 0.0151 (99.99%), Val Loss: 0.7174 (85.20%)
		✅ Best model updated: Val Acc = 85.20%

	Epoch [40/40] - Train Loss: 0.0144 (99.99%), Val Loss: 0.7203 (84.70%)

	Best model saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_mobilenet_v3_large/best_model_mobilenet_v3_large_100.pth
	Metric plot saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_mobilenet_v3_large/fine_tuning_metrics.png

==================================================
Starting fine-tuning for model: efficientnet_b0
==================================================

	Loading training and validation dataloaders...
	Training and validation dataloaders loaded.

	Loading model...
	Model loaded from: /home/ubuntu/Paper4_CNN_ViT_Comparison/pretraining/checkpoints/checkpoint_efficientnet_b0/best_model.pt

	Total model parameters: 4,135,648

	Epoch [1/40] - Train Loss: 4.4981 (4.19%), Val Loss: 4.2712 (11.80%)
		✅ Best model updated: Val Acc = 11.80%

	Epoch [2/40] - Train Loss: 4.0714 (20.71%), Val Loss: 3.8268 (34.70%)
		✅ Best model updated: Val Acc = 34.70%

	Epoch [3/40] - Train Loss: 3.5823 (41.53%), Val Loss: 3.2943 (50.90%)
		✅ Best model updated: Val Acc = 50.90%

	Epoch [4/40] - Train Loss: 3.0509 (56.51%), Val Loss: 2.7876 (60.10%)
		✅ Best model updated: Val Acc = 60.10%

	Epoch [5/40] - Train Loss: 2.5523 (66.93%), Val Loss: 2.3669 (67.00%)
		✅ Best model updated: Val Acc = 67.00%

	Epoch [6/40] - Train Loss: 2.1169 (74.41%), Val Loss: 1.9500 (72.80%)
		✅ Best model updated: Val Acc = 72.80%

	Epoch [7/40] - Train Loss: 1.7477 (80.00%), Val Loss: 1.6429 (77.00%)
		✅ Best model updated: Val Acc = 77.00%

	Epoch [8/40] - Train Loss: 1.4513 (83.14%), Val Loss: 1.3877 (79.90%)
		✅ Best model updated: Val Acc = 79.90%

	Epoch [9/40] - Train Loss: 1.2106 (85.89%), Val Loss: 1.1932 (82.10%)
		✅ Best model updated: Val Acc = 82.10%

	Epoch [10/40] - Train Loss: 1.0155 (88.24%), Val Loss: 1.0481 (83.00%)
		✅ Best model updated: Val Acc = 83.00%

	Epoch [11/40] - Train Loss: 0.8721 (89.46%), Val Loss: 0.9339 (84.70%)
		✅ Best model updated: Val Acc = 84.70%

	Epoch [12/40] - Train Loss: 0.7528 (90.79%), Val Loss: 0.8489 (84.60%)

	Epoch [13/40] - Train Loss: 0.6605 (91.71%), Val Loss: 0.7883 (85.50%)
		✅ Best model updated: Val Acc = 85.50%

	Epoch [14/40] - Train Loss: 0.5856 (92.24%), Val Loss: 0.7312 (86.00%)
		✅ Best model updated: Val Acc = 86.00%

	Epoch [15/40] - Train Loss: 0.5160 (93.59%), Val Loss: 0.6917 (86.80%)
		✅ Best model updated: Val Acc = 86.80%

	Epoch [16/40] - Train Loss: 0.4624 (93.96%), Val Loss: 0.6585 (87.40%)
		✅ Best model updated: Val Acc = 87.40%

	Epoch [17/40] - Train Loss: 0.4111 (94.61%), Val Loss: 0.6297 (86.80%)

	Epoch [18/40] - Train Loss: 0.3718 (95.21%), Val Loss: 0.6075 (87.30%)

	Epoch [19/40] - Train Loss: 0.3320 (95.79%), Val Loss: 0.5890 (87.60%)
		✅ Best model updated: Val Acc = 87.60%

	Epoch [20/40] - Train Loss: 0.3009 (96.29%), Val Loss: 0.5771 (87.60%)

	Epoch [21/40] - Train Loss: 0.2714 (96.79%), Val Loss: 0.5641 (87.90%)
		✅ Best model updated: Val Acc = 87.90%

	Epoch [22/40] - Train Loss: 0.2500 (96.94%), Val Loss: 0.5515 (88.10%)
		✅ Best model updated: Val Acc = 88.10%

	Epoch [23/40] - Train Loss: 0.2251 (97.41%), Val Loss: 0.5409 (88.00%)

	Epoch [24/40] - Train Loss: 0.2020 (97.81%), Val Loss: 0.5337 (88.20%)
		✅ Best model updated: Val Acc = 88.20%

	Epoch [25/40] - Train Loss: 0.1846 (97.86%), Val Loss: 0.5268 (88.10%)

	Epoch [26/40] - Train Loss: 0.1682 (98.24%), Val Loss: 0.5241 (87.90%)

	Epoch [27/40] - Train Loss: 0.1502 (98.54%), Val Loss: 0.5196 (88.10%)

	Epoch [28/40] - Train Loss: 0.1378 (98.71%), Val Loss: 0.5174 (88.00%)

	Epoch [29/40] - Train Loss: 0.1262 (98.84%), Val Loss: 0.5128 (88.30%)
		✅ Best model updated: Val Acc = 88.30%

	Epoch [30/40] - Train Loss: 0.1111 (99.11%), Val Loss: 0.5077 (88.60%)
		✅ Best model updated: Val Acc = 88.60%

	Epoch [31/40] - Train Loss: 0.1053 (99.04%), Val Loss: 0.5045 (88.30%)

	Epoch [32/40] - Train Loss: 0.0929 (99.30%), Val Loss: 0.5065 (88.50%)

	Epoch [33/40] - Train Loss: 0.0850 (99.39%), Val Loss: 0.5070 (88.30%)

	Epoch [34/40] - Train Loss: 0.0822 (99.43%), Val Loss: 0.5073 (88.40%)

	Epoch [35/40] - Train Loss: 0.0735 (99.47%), Val Loss: 0.5042 (88.20%)

	Epoch [36/40] - Train Loss: 0.0686 (99.63%), Val Loss: 0.5009 (88.20%)

	Epoch [37/40] - Train Loss: 0.0626 (99.60%), Val Loss: 0.5043 (88.00%)

	Epoch [38/40] - Train Loss: 0.0612 (99.70%), Val Loss: 0.5034 (88.10%)

	Epoch [39/40] - Train Loss: 0.0540 (99.76%), Val Loss: 0.5048 (88.00%)

	Epoch [40/40] - Train Loss: 0.0499 (99.81%), Val Loss: 0.5032 (88.30%)

	Best model saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_efficientnet_b0/best_model_efficientnet_b0_100.pth
	Metric plot saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_efficientnet_b0/fine_tuning_metrics.png

==================================================
Starting fine-tuning for model: vit_b_16
==================================================

	Loading training and validation dataloaders...
	Training and validation dataloaders loaded.

	Loading model...
	Model loaded from: /home/ubuntu/Paper4_CNN_ViT_Comparison/pretraining/checkpoints/checkpoint_vit_b_16/best_model.pt

	Total model parameters: 85,875,556

	Epoch [1/40] - Train Loss: 4.2542 (9.97%), Val Loss: 3.2843 (27.00%)
		✅ Best model updated: Val Acc = 27.00%

	Epoch [2/40] - Train Loss: 2.3716 (54.53%), Val Loss: 1.8945 (65.20%)
		✅ Best model updated: Val Acc = 65.20%

	Epoch [3/40] - Train Loss: 1.2468 (81.23%), Val Loss: 1.2241 (78.20%)
		✅ Best model updated: Val Acc = 78.20%

	Epoch [4/40] - Train Loss: 0.7432 (89.76%), Val Loss: 0.9287 (84.00%)
		✅ Best model updated: Val Acc = 84.00%

	Epoch [5/40] - Train Loss: 0.4973 (93.30%), Val Loss: 0.7748 (85.60%)
		✅ Best model updated: Val Acc = 85.60%

	Epoch [6/40] - Train Loss: 0.3515 (95.49%), Val Loss: 0.6874 (86.90%)
		✅ Best model updated: Val Acc = 86.90%

	Epoch [7/40] - Train Loss: 0.2554 (97.23%), Val Loss: 0.6325 (87.40%)
		✅ Best model updated: Val Acc = 87.40%

	Epoch [8/40] - Train Loss: 0.1874 (98.34%), Val Loss: 0.5954 (87.80%)
		✅ Best model updated: Val Acc = 87.80%

	Epoch [9/40] - Train Loss: 0.1377 (98.99%), Val Loss: 0.5683 (88.40%)
		✅ Best model updated: Val Acc = 88.40%

	Epoch [10/40] - Train Loss: 0.1022 (99.41%), Val Loss: 0.5484 (88.60%)
		✅ Best model updated: Val Acc = 88.60%

	Epoch [11/40] - Train Loss: 0.0759 (99.64%), Val Loss: 0.5360 (89.00%)
		✅ Best model updated: Val Acc = 89.00%

	Epoch [12/40] - Train Loss: 0.0574 (99.84%), Val Loss: 0.5244 (89.10%)
		✅ Best model updated: Val Acc = 89.10%

	Epoch [13/40] - Train Loss: 0.0445 (99.94%), Val Loss: 0.5139 (89.00%)

	Epoch [14/40] - Train Loss: 0.0352 (100.00%), Val Loss: 0.5059 (88.90%)

	Epoch [15/40] - Train Loss: 0.0288 (100.00%), Val Loss: 0.4981 (89.20%)
		✅ Best model updated: Val Acc = 89.20%

	Epoch [16/40] - Train Loss: 0.0241 (100.00%), Val Loss: 0.4918 (89.20%)

	Epoch [17/40] - Train Loss: 0.0205 (100.00%), Val Loss: 0.4860 (89.30%)
		✅ Best model updated: Val Acc = 89.30%

	Epoch [18/40] - Train Loss: 0.0177 (100.00%), Val Loss: 0.4811 (89.30%)

	Epoch [19/40] - Train Loss: 0.0155 (100.00%), Val Loss: 0.4771 (89.10%)

	Epoch [20/40] - Train Loss: 0.0137 (100.00%), Val Loss: 0.4732 (89.30%)

	Epoch [21/40] - Train Loss: 0.0123 (100.00%), Val Loss: 0.4695 (89.40%)
		✅ Best model updated: Val Acc = 89.40%

	Epoch [22/40] - Train Loss: 0.0110 (100.00%), Val Loss: 0.4664 (89.40%)

	Epoch [23/40] - Train Loss: 0.0099 (100.00%), Val Loss: 0.4634 (89.60%)
		✅ Best model updated: Val Acc = 89.60%

	Epoch [24/40] - Train Loss: 0.0090 (100.00%), Val Loss: 0.4610 (89.50%)

	Epoch [25/40] - Train Loss: 0.0082 (100.00%), Val Loss: 0.4583 (89.60%)

	Epoch [26/40] - Train Loss: 0.0075 (100.00%), Val Loss: 0.4563 (89.60%)

	Epoch [27/40] - Train Loss: 0.0069 (100.00%), Val Loss: 0.4543 (89.60%)

	Epoch [28/40] - Train Loss: 0.0063 (100.00%), Val Loss: 0.4523 (89.60%)

	Epoch [29/40] - Train Loss: 0.0059 (100.00%), Val Loss: 0.4508 (89.80%)
		✅ Best model updated: Val Acc = 89.80%

	Epoch [30/40] - Train Loss: 0.0054 (100.00%), Val Loss: 0.4490 (89.80%)

	Epoch [31/40] - Train Loss: 0.0050 (100.00%), Val Loss: 0.4476 (89.70%)

	Epoch [32/40] - Train Loss: 0.0047 (100.00%), Val Loss: 0.4463 (89.80%)

	Epoch [33/40] - Train Loss: 0.0044 (100.00%), Val Loss: 0.4447 (89.90%)
		✅ Best model updated: Val Acc = 89.90%

	Epoch [34/40] - Train Loss: 0.0041 (100.00%), Val Loss: 0.4439 (90.00%)
		✅ Best model updated: Val Acc = 90.00%

	Epoch [35/40] - Train Loss: 0.0038 (100.00%), Val Loss: 0.4427 (90.00%)

	Epoch [36/40] - Train Loss: 0.0036 (100.00%), Val Loss: 0.4417 (90.10%)
		✅ Best model updated: Val Acc = 90.10%

	Epoch [37/40] - Train Loss: 0.0034 (100.00%), Val Loss: 0.4405 (90.10%)

	Epoch [38/40] - Train Loss: 0.0032 (100.00%), Val Loss: 0.4396 (90.00%)

	Epoch [39/40] - Train Loss: 0.0030 (100.00%), Val Loss: 0.4387 (90.00%)

	Epoch [40/40] - Train Loss: 0.0028 (100.00%), Val Loss: 0.4379 (90.10%)

	Best model saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_vit_b_16/best_model_vit_b_16_100.pth
	Metric plot saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface/results_vit_b_16/fine_tuning_metrics.png

==================================================
Fine-tuning completed for all models.
Results saved to: /home/ubuntu/Paper4_CNN_ViT_Comparison/CASIA-WebFace/finetune_evaluation_casia_webface
==================================================
